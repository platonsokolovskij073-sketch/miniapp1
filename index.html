<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Starify ‚Äî MiniApp</title>
<script src="https://telegram.org/js/telegram-web-app.js"></script>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
<style>
:root{
  /* HALLOWEEN THEME */
  --bg:#0b0a12;
  --bg2:#140f1f;
  --card:rgba(255,255,255,.06);
  --line:rgba(255,255,255,.10);
  --text:#f7f4ff;
  --muted:#b7abc9;
  --accent:#ff7a18; /* orange */
  --accent2:#9c5cff; /* purple */
  --ok:#35ffb1;
  --danger:#ff3b6b;
  --shadow:0 20px 40px rgba(0,0,0,.35);
}
*{box-sizing:border-box}
body{
  margin:0; font-family:"Inter",system-ui,Segoe UI,Roboto,Arial,sans-serif; color:var(--text);
  background:
    radial-gradient(900px 400px at 110% -10%, rgba(156,92,255,.22), transparent 60%),
    radial-gradient(1200px 600px at -10% 10%, rgba(255,122,24,.18), transparent 60%),
    linear-gradient(180deg,var(--bg),var(--bg2));
  min-height:100svh; display:flex; flex-direction:column;
}

/* Header */
.header{
  position:sticky; top:0; z-index:10; padding:12px 16px; display:flex; align-items:center; gap:12px;
  background:linear-gradient(180deg, rgba(0,0,0,.55), rgba(0,0,0,.2));
  backdrop-filter:blur(14px) saturate(140%); -webkit-backdrop-filter:blur(14px) saturate(140%);
  border-bottom:1px solid var(--line);
}
.logo{width:36px; height:36px; border-radius:12px; display:grid; place-items:center; font-weight:800;
  background:conic-gradient(from 0deg, #ffb86b, #ff7a18, #9c5cff, #ffb86b);
  color:#150b00; box-shadow:var(--shadow)}
.title{font-weight:800; letter-spacing:.3px}
.subtitle{font-size:12px; color:var(--muted)}

/* Containers */
.container{padding:16px; display:none; animation:fade .25s ease forwards}
.container.active{display:block}
.grid{display:grid; gap:12px}
.cols-2{grid-template-columns:repeat(2,minmax(0,1fr))}
.card{
  background:var(--card); border:1px solid var(--line); border-radius:20px; padding:14px; box-shadow:var(--shadow);
  transition:.25s transform,.25s background,.25s box-shadow;
}
.card:hover{transform:translateY(-2px)}
.card h3{margin:.2rem 0 .4rem; font-size:16px}
.card p{margin:0; font-size:12px; color:var(--muted)}
.row{display:flex; align-items:center; justify-content:space-between; gap:10px; flex-wrap:wrap}
.badge{font-size:12px; padding:6px 8px; border-radius:10px; background:rgba(255,255,255,.10); border:1px solid var(--line); color:var(--muted)}
.hr{height:1px; background:var(--line); margin:6px 0 2px}

/* Buttons */
.btn{appearance:none; border:0; cursor:pointer; padding:12px 14px; border-radius:16px; font-weight:800; color:#1b0b00;
  background:linear-gradient(135deg, var(--accent), #ffb86b); box-shadow:0 12px 26px rgba(255,122,24,.35); transition:transform .15s,filter .2s}
.btn:active{transform:scale(.98)}
.btn.purple{background:linear-gradient(135deg, var(--accent2), #c39aff); color:#0c0216; box-shadow:0 12px 26px rgba(156,92,255,.35)}
.btn.ghost{background:transparent; color:var(--text); border:1px solid var(--line); box-shadow:none}

/* Big quick buttons on Home */
.bigbtn{display:flex; gap:12px}
.bigbtn .btn{flex:1; font-size:15px}

/* Bottom nav */
.nav{
  position:sticky; bottom:0; z-index:10; display:grid; grid-template-columns:repeat(5,1fr); gap:8px; padding:10px;
  background:linear-gradient(180deg, rgba(0,0,0,0), rgba(0,0,0,.55)); backdrop-filter:blur(12px); -webkit-backdrop-filter:blur(12px);
  border-top:1px solid var(--line);
}
.tab{
  appearance:none; border:1px solid var(--line); background:rgba(255,255,255,.06); color:#fff;
  padding:12px 8px; border-radius:16px; font-size:12px; display:flex; flex-direction:column; align-items:center; gap:4px
}
.tab span{opacity:.85; font-size:11px}
.tab.active{background:linear-gradient(135deg, rgba(255,122,24,.18), rgba(156,92,255,.18))}

/* Shop tiles */
.tile{display:flex; align-items:center; justify-content:space-between; gap:10px}
.price{font-weight:800}
.input{
  width:100%; padding:12px 12px; border-radius:14px; border:1px solid var(--line); background:rgba(255,255,255,.06); color:var(--text);
}

/* Slot */
.slot-wrap{display:grid; place-items:center; gap:10px}
.slot{
  width:280px; height:110px; border-radius:18px; overflow:hidden; position:relative;
  background:rgba(0,0,0,.35); border:1px solid var(--line); box-shadow:var(--shadow); display:grid; grid-template-columns:repeat(3,1fr); gap:8px; padding:8px;
}
.reel{background:rgba(255,255,255,.08); border:1px solid var(--line); border-radius:12px; display:grid; place-items:center; font-size:36px; font-weight:800}
.reel.spin{animation:spin 1.1s cubic-bezier(.2,.7,.2,1) infinite}
@keyframes spin{0%{transform:translateY(0)}100%{transform:translateY(-100%)}}

/* Emoji/confetti */
.particle{position:fixed; top:-20px; font-size:22px; animation:fall linear forwards}
@keyframes fall{to{transform:translateY(105vh) rotate(360deg); opacity:.95}}

/* Toast */
.toast{position:fixed; left:50%; bottom:120px; transform:translateX(-50%) translateY(20px); background:rgba(0,0,0,.8);
  border:1px solid var(--line); color:#fff; padding:10px 14px; border-radius:12px; opacity:0; pointer-events:none; transition:opacity .2s, transform .2s; font-size:13px}
.toast.show{opacity:1; transform:translateX(-50%) translateY(0)}
@keyframes fade{from{opacity:0; transform:translateY(6px)} to{opacity:1; transform:translateY(0)}}
</style>
</head>
<body>
  <!-- HEADER -->
  <div class="header">
    <div class="logo">ü¶á</div>
    <div>
      <div class="title">Starify</div>
      <div class="subtitle">–º–∞–≥–∞–∑–∏–Ω ‚Ä¢ –º–∏–Ω–∏-–∏–≥—Ä—ã ‚Ä¢ —Ä–µ—Ñ–µ—Ä–∞–ª–∫–∞</div>
    </div>
    <div style="margin-left:auto" class="badge" id="userBadge">@guest</div>
  </div>

  <!-- HOME (–º–∏–Ω–∏–º—É–º —Ç–µ–∫—Å—Ç–∞) -->
  <section class="container active" id="home">
    <div class="card">
      <!-- <img src="assets/banner.webp" alt="" style="width:100%;border-radius:14px;opacity:.9;margin-bottom:10px"> -->
      <h3>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ Starify üéÉ</h3>
      <div class="bigbtn" style="margin-top:10px">
        <button class="btn" data-tab-go="shop">üõí –ú–∞–≥–∞–∑–∏–Ω</button>
        <button class="btn purple" data-tab-go="games">üé≤ –ò–≥—Ä—ã</button>
        <button class="btn ghost" data-tab-go="ref">ü§ù –†–µ—Ñ–µ—Ä–∞–ª–∫–∞</button>
      </div>
    </div>
  </section>

  <!-- SHOP (–∑–≤—ë–∑–¥—ã + premium) -->
  <section class="container" id="shop">
    <div class="card">
      <h3>–ú–∞–≥–∞–∑–∏–Ω</h3>
      <p>–í—ã–±–µ—Ä–∏ –∑–≤—ë–∑–¥—ã –∏–ª–∏ Premium. –ü—Ä–∏ –ø–æ–∫—É–ø–∫–µ —Å—Ä–∞–∑—É –ø–µ—Ä–µ–π–¥—ë–º –∫ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—é.</p>
      <div class="hr"></div>

      <div class="grid cols-2" style="margin-top:6px">
        <!-- Stars quick packs -->
        <div class="card">
          <h3>‚≠ê –ó–≤—ë–∑–¥—ã</h3>
          <div class="grid" id="starsQuick"></div>
          <div class="hr"></div>
          <div class="tile">
            <div style="flex:1">
              <div class="badge" style="margin-bottom:6px">–°–≤–æ–π –ª–æ—Ç</div>
              <input id="customStars" class="input" type="number" min="1" placeholder="–í–≤–µ–¥–∏—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–≤—ë–∑–¥">
            </div>
            <button class="btn purple" id="buyCustomStars">–ö—É–ø–∏—Ç—å</button>
          </div>
        </div>

        <!-- Premium plans -->
        <div class="card">
          <h3>üíé Premium</h3>
          <div class="grid" id="premiumPlans"></div>
        </div>
      </div>
    </div>
  </section>

  <!-- CHECKOUT (—é–∑–µ—Ä + –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ) -->
  <section class="container" id="checkout">
    <div class="card">
      <h3>–û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ</h3>
      <p id="checkoutWhat">–í—ã–±—Ä–∞–Ω–Ω—ã–π —Ç–æ–≤–∞—Ä</p>
      <div class="hr"></div>
      <div class="grid">
        <input id="username" class="input" type="text" placeholder="–í–≤–µ–¥–∏—Ç–µ @username –ø–æ–ª—É—á–∞—Ç–µ–ª—è">
        <input id="amount" class="input" type="number" min="1" placeholder="–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ (–¥–ª—è –∑–≤—ë–∑–¥)">
        <button class="btn" id="proceed">–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å</button>
        <button class="btn ghost" data-tab-go="shop">–ù–∞–∑–∞–¥ –≤ –º–∞–≥–∞–∑–∏–Ω</button>
      </div>
    </div>
  </section>

  <!-- GAMES -->
  <section class="container" id="games">
    <div class="card">
      <h3>–ú–∏–Ω–∏-–∏–≥—Ä—ã</h3>
      <p>–í—ã–±–µ—Ä–∏ —Ä–µ–∂–∏–º: —Å–ª–æ—Ç-–º–∞—à–∏–Ω–∞ –∏–ª–∏ –∞–Ω–∏–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∏–≥—Ä—ã (–±–∞—Å–∫–µ—Ç–±–æ–ª, –±–æ—É–ª–∏–Ω–≥, –¥–∞—Ä—Ç—Å).</p>
      <div class="row" style="margin-top:8px">
        <button class="btn" data-game="slot">üé∞ –°–ª–æ—Ç</button>
        <button class="btn purple" data-game="basket">üèÄ –ë–∞—Å–∫–µ—Ç–±–æ–ª</button>
        <button class="btn ghost" data-game="bowling">üé≥ –ë–æ—É–ª–∏–Ω–≥</button>
        <button class="btn ghost" data-game="darts">üéØ –î–∞—Ä—Ç—Å</button>
      </div>
    </div>

    <div class="card slot-wrap" id="slotBox">
      <div class="slot" id="slot">
        <div class="reel" id="reel1">üéÉ</div>
        <div class="reel" id="reel2">üï∑Ô∏è</div>
        <div class="reel" id="reel3">ü¶á</div>
      </div>
      <div class="row">
        <button class="btn" id="spinBtn">Spin</button>
        <button class="btn purple" id="confettiBtn">–ö–æ–Ω—Ñ–µ—Ç—Ç–∏</button>
      </div>
      <span class="badge" id="slotOut">–£–¥–∞—á–∏!</span>
    </div>
  </section>

  <!-- REFERRAL -->
  <section class="container" id="ref">
    <div class="card">
      <h3>–†–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞ üßô‚Äç‚ôÄÔ∏è</h3>
      <p>–ü–æ–¥–µ–ª–∏—Å—å —Å—Å—ã–ª–∫–æ–π ‚Äî –¥—Ä—É–≥ –ø–æ–ª—É—á–∏—Ç —Å–∫–∏–¥–∫—É, –∞ —Ç—ã –±–æ–Ω—É—Å –∑–≤—ë–∑–¥–∞–º–∏.</p>
      <div class="hr"></div>
      <div class="row" style="margin-top:8px">
        <input id="refLink" class="input" readonly value="https://t.me/your_bot_here?start=ref_0000">
        <button class="btn purple" id="copyRef">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button>
      </div>
      <div class="row" style="margin-top:8px">
        <button class="btn ghost">–ú–æ–∏ —Ä–µ—Ñ–µ—Ä–∞–ª—ã (0)</button>
        <button class="btn ghost">–ü—Ä–∞–≤–∏–ª–∞</button>
      </div>
    </div>
  </section>

  <!-- PROFILE (–º–∏–Ω–∏–º—É–º) -->
  <section class="container" id="profile">
    <div class="card">
      <h3>–ü—Ä–æ—Ñ–∏–ª—å</h3>
      <p id="whoami">–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –ø–æ–¥—Ç—è–Ω–µ—Ç—Å—è –∏–∑ Telegram, –µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω–æ.</p>
      <div class="row" style="margin-top:8px">
        <button class="btn ghost" id="closeBtn">–ó–∞–∫—Ä—ã—Ç—å MiniApp</button>
      </div>
    </div>
  </section>

  <!-- NAV -->
  <nav class="nav">
    <button class="tab active" data-tab="home">üè†<span>–î–æ–º</span></button>
    <button class="tab" data-tab="shop">üõí<span>–ú–∞–≥–∞–∑–∏–Ω</span></button>
    <button class="tab" data-tab="games">üé≤<span>–ò–≥—Ä—ã</span></button>
    <button class="tab" data-tab="ref">ü§ù<span>–†–µ—Ñ–µ—Ä–∞–ª–∫–∞</span></button>
    <button class="tab" data-tab="profile">üë§<span>–ü—Ä–æ—Ñ–∏–ª—å</span></button>
  </nav>

  <div class="toast" id="toast">–ì–æ—Ç–æ–≤–æ!</div>

<script>
const tg = window.Telegram?.WebApp;

/* Theme + user */
function applyTheme(){
  if(!tg) return;
  const t = tg.themeParams || {};
  document.documentElement.style.setProperty('--line', t.section_separator_color || 'rgba(255,255,255,.10)');
}
(function hydrateUser(){
  try{
    const user = tg?.initDataUnsafe?.user;
    if(user){
      document.getElementById('userBadge').textContent = user.username ? '@'+user.username : (user.first_name||'user');
      document.getElementById('whoami').textContent = `–¢—ã: ${user.first_name||''} ${user.last_name||''} ${user.username?'(@'+user.username+')':''}`;
      const link = `https://t.me/${tg?.initDataUnsafe?.receiver?.username || 'your_bot_here'}?start=ref_${user.id}`;
      document.getElementById('refLink').value = link;
    }
  }catch{}
})();

/* Toast + confetti */
const toast = (m='–ì–æ—Ç–æ–≤–æ!')=>{
  const el=document.getElementById('toast'); el.textContent=m; el.classList.add('show');
  setTimeout(()=>el.classList.remove('show'),1500);
};
const confetti = ()=>{
  const icons = ['üéÉ','ü¶á','üï∑Ô∏è','üï∏Ô∏è','‚ú®','üí•','üéâ'];
  for(let i=0;i<28;i++){
    const p=document.createElement('div'); p.className='particle';
    p.textContent=icons[Math.floor(Math.random()*icons.length)];
    p.style.left=Math.random()*100+'vw';
    p.style.animationDuration=(1.1+Math.random()*1.3)+'s';
    document.body.appendChild(p); setTimeout(()=>p.remove(),2400);
  }
};

/* Navigation */
const tabs=[...document.querySelectorAll('.tab')];
const sections=[...document.querySelectorAll('.container')];
function openTab(id){
  tabs.forEach(t=>t.classList.toggle('active', t.dataset.tab===id));
  sections.forEach(s=>s.classList.toggle('active', s.id===id));
}
tabs.forEach(t=>t.addEventListener('click',()=>openTab(t.dataset.tab)));
document.querySelectorAll('[data-tab-go]').forEach(b=>b.onclick=()=>openTab(b.dataset.tabGo));

/* Shop data */
const starsQuick = [
  {name:'500 ‚≠ê', qty:500},
  {name:'1 000 ‚≠ê', qty:1000},
  {name:'2 500 ‚≠ê', qty:2500},
  {name:'5 000 ‚≠ê', qty:5000},
];
const premiumPlans = [
  {name:'1 –º–µ—Å—è—Ü', plan:'1m'},
  {name:'3 –º–µ—Å—è—Ü–∞', plan:'3m'},
  {name:'6 –º–µ—Å—è—Ü–µ–≤', plan:'6m'},
  {name:'12 –º–µ—Å—è—Ü–µ–≤', plan:'12m'},
];

const elStarsQuick = document.getElementById('starsQuick');
starsQuick.forEach(p=>{
  const c=document.createElement('div'); c.className='tile';
  c.innerHTML=`<div>${p.name}</div><button class="btn" data-buy-stars="${p.qty}">–ö—É–ø–∏—Ç—å</button>`;
  elStarsQuick.appendChild(c);
});
const elPremium = document.getElementById('premiumPlans');
premiumPlans.forEach(p=>{
  const c=document.createElement('div'); c.className='tile';
  c.innerHTML=`<div>${p.name}</div><button class="btn purple" data-buy-premium="${p.plan}">–ö—É–ø–∏—Ç—å</button>`;
  elPremium.appendChild(c);
});

/* Checkout flow (–±–µ–∑ –ª–æ–≥–∏–∫–∏ –æ–ø–ª–∞—Ç—ã) */
let checkoutState = { type:null, label:'', qty:null, plan:null };
const checkoutWhat = document.getElementById('checkoutWhat');
const username = document.getElementById('username');
const amount = document.getElementById('amount');

function goCheckout(state){
  checkoutState = state;
  // –ø–æ–¥–ø–∏—Å–∏
  if(state.type==='stars'){
    checkoutWhat.textContent = `–ü–æ–∫—É–ø–∫–∞ –∑–≤—ë–∑–¥: ${state.qty ? state.qty+' ‚≠ê' : '—É–∫–∞–∂–∏—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–∏–∂–µ'}`;
    amount.value = state.qty || '';
    amount.placeholder = "–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–≤—ë–∑–¥";
    amount.parentElement.style.display = '';
  } else {
    checkoutWhat.textContent = `–û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ Telegram Premium: ${state.plan}`;
    amount.value=''; amount.parentElement.style.display='none';
  }
  openTab('checkout');
  username.focus();
}

document.addEventListener('click', (e)=>{
  const s = e.target.closest('[data-buy-stars]');
  const p = e.target.closest('[data-buy-premium]');
  if(s){ goCheckout({type:'stars', label:'–ó–≤—ë–∑–¥—ã', qty:parseInt(s.dataset.buyStars,10)}); }
  if(p){ goCheckout({type:'premium', label:'Premium', plan:p.dataset.buyPremium}); }
});

document.getElementById('buyCustomStars').onclick=()=>{
  const qty = parseInt(document.getElementById('customStars').value,10);
  goCheckout({type:'stars', label:'–ó–≤—ë–∑–¥—ã', qty: isNaN(qty)?null:qty});
};

document.getElementById('proceed').onclick=()=>{
  // –ø–æ–∫–∞ –ø—Ä–æ—Å—Ç–æ –≤–∏–∑—É–∞–ª—å–Ω—ã–π —Ñ–∏–Ω–∞–ª
  const u = username.value.trim() || '@username';
  const q = amount.value? ` ‚Ä¢ ${amount.value} ‚≠ê` : '';
  toast(`–ó–∞—è–≤–∫–∞: ${checkoutState.label} ‚Üí ${u}${q}`);
  confetti();
};

/* Games */
const symbols = ['üéÉ','üï∑Ô∏è','ü¶á','üï∏Ô∏è','üç¨','7Ô∏è‚É£'];
const reels = [document.getElementById('reel1'),document.getElementById('reel2'),document.getElementById('reel3')];
const spinBtn=document.getElementById('spinBtn');
const slotOut=document.getElementById('slotOut');
function randSym(){ return symbols[Math.floor(Math.random()*symbols.length)]; }
let spinning=false;
spinBtn.onclick=()=>{
  if(spinning) return;
  spinning=true; slotOut.textContent='–ö—Ä—É—Ç–∏–º...'; spinBtn.disabled=true;
  reels.forEach(r=>{ r.classList.add('spin'); r.textContent=randSym(); });
  setTimeout(()=>{
    reels.forEach(r=>r.classList.remove('spin'));
    const res=[randSym(),randSym(),randSym()];
    reels.forEach((r,i)=>r.textContent=res[i]);
    const win=res[0]===res[1] && res[1]===res[2];
    if(win){ slotOut.textContent='–ü–æ–±–µ–¥–∞! üéâ'; confetti(); } else { slotOut.textContent='–ü–æ—á—Ç–∏!' }
    spinBtn.disabled=false; spinning=false;
  },1400);
};
document.getElementById('confettiBtn').onclick=()=>confetti();

/* Game mode buttons (–≤–∏–∑—É–∞–ª) */
document.querySelectorAll('[data-game]').forEach(b=>{
  b.addEventListener('click',()=>{
    const mode = b.dataset.game;
    toast(`–†–µ–∂–∏–º: ${mode==='slot'?'–°–ª–æ—Ç':'–ê–Ω–∏–º–∞—Ü–∏—è '+mode}`);
    // —Ç—É—Ç –º–æ–∂–Ω–æ –ø–æ–¥—Å–≤–µ—Ç–∏—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—ã–π —Ä–µ–∂–∏–º/–ø–æ–¥–≥—Ä—É–∑–∏—Ç—å –∞–Ω–∏–º–∞—Ü–∏—é
  });
});

/* Referral */
document.getElementById('copyRef').onclick=async()=>{
  try{
    await navigator.clipboard.writeText(document.getElementById('refLink').value);
    toast('–°—Å—ã–ª–∫–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞');
  }catch{ toast('–°–∫–æ–ø–∏—Ä—É–π –≤—Ä—É—á–Ω—É—é'); }
};

/* Close */
document.getElementById('closeBtn').onclick=()=>tg?.close?.();

/* Init */
tg?.ready?.(); tg?.expand?.(); applyTheme();
</script>
</body>
</html>
